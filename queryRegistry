Write-Output "These are the available Registry Queries"





$Tab = [char]9

Write-Output "$Tab 1. Check for passwords in Current User registry keys"

Write-Output "$Tab 2. Check for passwords in Local Machine registry keys"

Write-Output "$Tab 3. Check for programs that are configured to run at logon (Current User)"
Write-Output "$Tab 4. Check for programs that are configured to run at logon (Local Machine)"
Write-Output "$Tab 5. Check for commands run using the run program"




$name = Read-Host 'What number would you like to query?'

if ($name -eq 1) {

    $HKCUPasswords = reg query HKCU /f password /t REG_SZ /s

    Write-Output $HKCUPasswords             
}

elseif ($name -eq 2) {

        $HKLMPasswords = reg query HKLM /f password /t REG_SZ /s

        Write-Output $HKLMPasswords

}

elseif ($name -eq 3) {

       $RunRegKeysCU =  Get-ItemProperty -Path Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run

       Write-Output $RunRegKeysCU
}

elseif ($name -eq 4) {

       $RunRegKeysLM =   Get-ItemProperty -Path Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run

       Write-Output $RunRegKeysLM
}
elseif ($name -eq 5) { 
        $RunCommands =  Get-ItemProperty -Path Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU 
        Write-Output $RunCommands
}
